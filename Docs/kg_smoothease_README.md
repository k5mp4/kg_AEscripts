# kg_smoothease.jsx

**バージョン:** 1.3.0  
**作者:** kg_scripts

キーフレーム間のテンポラルイージングを自動的に滑らかに接続するAfter Effectsスクリプトです。

---

## 概要

モーションデザインにおいて、キーフレーム間の滑らかな接続は非常に重要です。このスクリプトは、選択したキーフレームのイン・アウトハンドルを自動調整し、C1連続性（接線連続）を実現します。

### 主な特徴

- **即座実行**: UIなしで選択したキーフレームに即座に適用
- **元の形を維持**: 既存のハンドル位置をなるべく保持
- **自動最適化**: 1-5%の範囲で最も滑らかになる角度を自動計算
- **中間点の微細角度**: 3点選択時、中間キーに自然な傾斜を付与

---

## 使い方

### 基本的な使用方法

1. After Effectsでコンポジションを開く
2. タイムラインでキーフレームを持つプロパティを選択
3. `File` > `Scripts` > `Run Script File...` からスクリプトを実行
4. 選択したキーフレームに即座にイージングが適用される

### 推奨ワークフロー

1. **3点キーフレーム選択**: 開始点、中間点、終了点の3つを選択
2. スクリプト実行
3. 中間点に全体の動きに基づく微細な角度が自動付与される

---

## 技術仕様

### アルゴリズム

1. **速度の平均化**: イン側とアウト側の速度を平均化してC1連続を実現
2. **影響度の維持**: 元のInfluence値を保持してハンドル長を維持
3. **全体傾向の計算**: 最初と最後のキーフレームから全体のトレンドを算出
4. **最適角度の探索**: 1-5%の範囲で速度分散が最小になる値を選択

### 対応プロパティ

- Position（位置）
- Scale（スケール）
- Rotation（回転）
- Opacity（不透明度）
- その他すべてのテンポラルイージング対応プロパティ

---

## 更新履歴

### v1.3.0
- UIなしの即座実行モードに変更
- 1-5%範囲での最適角度自動計算機能を追加
- 中間キーフレームへの微細角度付与機能

### v1.2.0
- 中間点の角度バイアス機能を追加
- UIにスライダーコントロールを追加

### v1.1.1
- Influence値のクランプ処理を追加（エラー修正）
- UIを日本語化

### v1.1.0
- 「元のハンドル長さを維持」オプションを追加

### v1.0.1
- ExtendScript互換性の修正（Array.isArray問題）

### v1.0.0
- 初回リリース
- C1/C2連続性モード
- Catmull-Romスプラインベースの接線計算

---

## 注意事項

- 最低2つ以上のキーフレームが必要です
- 補間タイプは自動的にベジェに設定されます
- Undoで元に戻せます

---

## ライセンス

このスクリプトは自由にご使用いただけます。
